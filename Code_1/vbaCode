Dim CAT() As String
Sub BuildCategories()
    Dim i, j, k, n As Integer
    Dim matrixCol, matrixCat(), pos As Integer
    Dim CAT() As Categories
    Dim wasAdded As Boolean
    'Worksheets("List").Cells(Rows.Count, 3).End(xlUp).Row
    
    matrixCol = 0
    For j = 2 To Worksheets(1).Cells(1, Columns.Count).End(xlToLeft).Column
        matrixCol = matrixCol + 1
    Next j

    ReDim CAT(1 To matrixCol)

    For j = 2 To Worksheets(1).Cells(1, Columns.Count).End(xlToLeft).Column
        n = 0
        ReDim Preserve CAT(j - 1).Category(1 To 1)
        For i = 2 To Worksheets(1).Cells(Rows.Count, j).End(xlUp).Row
            'wasAdded = False
            For k = LBound(CAT(j - 1).Category) To UBound(CAT(j - 1).Category)
                If (CAT(j - 1).Category(k) = Worksheets(1).Cells(i, j).Value) Then
                    GoTo NEXTCHECK
                End If
            Next k
            n = n + 1
            ReDim Preserve CAT(j - 1).Category(1 To n)
            CAT(j - 1).Category(n) = Worksheets(1).Cells(i, j).Value
NEXTCHECK:
        Next i
    Next j
    
    n = 1
    For i = LBound(CAT) To UBound(CAT)
        n = n * UBound(CAT(i).Category)
    Next i
    MsgBox ("Building " + Format(n, "##") + " groups"), vbOKOnly, "### Your Box 1 Title ###"
    
    ReDim matrixCat(1 To UBound(CAT))
    For j = LBound(CAT) To UBound(CAT)
        matrixCat(j) = LBound(CAT(j).Category)
    Next j
    
    pos = UBound(matrixCat)
    For g = 1 To n
        Worksheets(2).Cells(g, 1).Value = "Group " + Format(g, "##")
        For j = LBound(matrixCat) To UBound(matrixCat)
            If j <> UBound(matrixCat) Then
                Worksheets(2).Cells(g, 2).Value = Worksheets(2).Cells(g, 2).Value + CAT(j).Category(matrixCat(j)) + " " 'vbCrLf
            Else
                Worksheets(2).Cells(g, 2).Value = Worksheets(2).Cells(g, 2).Value + CAT(j).Category(matrixCat(j))
            End If
        Next j
        
        For i = UBound(matrixCat) To pos Step -1
            If (matrixCat(i) < UBound(CAT(i).Category)) Then
                matrixCat(i) = matrixCat(i) + 1
                GoTo NEXTGROUP
            ElseIf (i = pos And pos <> 0) Then
                matrixCat(i) = LBound(CAT(i).Category)
                pos = pos - 1
                If (pos = 0) Then GoTo NEXTGROUP
                matrixCat(pos) = matrixCat(pos) + 1
            Else
                matrixCat(i) = LBound(CAT(i).Category)
            End If
        Next i
NEXTGROUP:
    Next g
    MsgBox (Format(g - 1, "##") + " groups"), vbOKOnly, "### Your Box 2 Title ###"        
End Sub
